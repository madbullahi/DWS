---
title: "Data analysis of chemical data"
author: "Muhammad"
date: "08/10/22"
---
# Load the required packages
```{r}
library(readxl)# This package is useful for data import.
library(tidyverse)# package collection namely: {dplyr-} for data wrangling, {tibble-} for dataframes

# Packages for data analysis.
 library(lmerTest)
library(stats) 

```

```{r Analysis of Diclofenac(single compound:raw data)}
# Import the raw data for Diclofenac.
Dfs <- read_excel(file.choose(), sheet = "Diclofenac-raw")

head(Dfs)

# Anova
Genotype <- Dfs[, "Genotype"]
Treatment <- Dfs[, "Treatment"]
DAY <- Dfs[, "DAY"]

Dfs_lme <- lmer(concentration ~ Treatment*Genotype*DAY +(1|Genotype:Replicates), data = Dfs)

anova(Dfs_lme) # it gives a summary of the model.

tidy_DicSin_raw <- tidy(Dfs_lme) # tidies the summary from the anova.

write.csv(tidy_DicSin_raw,'Diclofenac_SIngle_raw.csv') # export the anova summary as a csv file.
```

```{r Analysis of Diclofenac removal efficiency(single compound)}
# Import the data
Df_reff_Single <- read_excel(file.choose(), sheet = "Dic_reff_single")

head(Df_reff_Single)

# Anova
Genotype <- Df_reff_Single[, "Genotype"]
Day <- Df_reff_Single[, "Day"]

Dfrem_lme <- lmer(RE ~ Genotype*Day + (1|Genotype:Replicates), data = Df_reff_Single)

anova(Dfrem_lme) # it gives a summary of the model

tidy_Dic_reff_Sin_raw <- tidy(Dfrem_lme) # tidies the summary from the anova.

write.csv(tidy_Dic_reff_Sin_raw,'Dic_reff_SIngle_raw.csv') # export the anova summary as a csv file.
```

```{r Analysis of Diclofenac(wastewater:raw data)}
# Import the data
Dfw_raw <- read_excel(file.choose(), sheet = "Dic_raw_ww")

head(Dfw_raw)

# Anova
GENOTYPE <- Dfw_raw[, "GENOTYPE"]
TREATMENT <- Dfw_raw[, "TREATMENT"]
DAY <- Dfw_raw[, "DAY"]

Dfw_lme <- lmer(concentration ~ TREATMENT*GENOTYPE*DAY +(1|GENOTYPE:Replicates), data = Dfw_raw)

anova(Dfw_lme) # it gives a summary of the model.

tidy_Dic_ww_raw <- tidy(Dfw_lme) # tidies the summary from the anova.

write.csv(tidy_Dic_ww_raw,'Diclofenac_ww_raw.csv') # export the anova summary as a csv file.
```

```{r Analysis of Diclofenac removal efficiency (wastewater)}
# Import the data
DfwW_reff <- read_excel(file.choose(), sheet = "Dic-ww-reff")

head(DfwW_reff)

# Anova
Genotype <- DfwW_reff[, "Genotype"]
Day <- DfwW_reff[, "Day"]

Df_ww_rem_lme <- lmer(RE ~ Genotype*Day + (1|Genotype:Replicates), data = DfwW_reff)

anova(Df_ww_rem_lme) # it gives a summary of the model

tidy_Dic_ww_reff <- tidy(Df_ww_rem_lme) # tidies the summary from the anova.

write.csv(tidy_Dic_ww_reff,'Dic_reff_ww.csv') # export the anova summary as a csv file.
```

